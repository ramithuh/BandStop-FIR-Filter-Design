\documentclass[11pt]{article} 
%%%%%%%%%%%% PREAMBULO %%%%%%%%%%%%%%%%%%
\usepackage[T1]{fontenc}%indica que usamos la ñ
\usepackage[utf8]{inputenc}%indica el tipo de codificación ISO-8859-1 (latin)ó utf8
\usepackage[english]{babel}%indica que escribiremos en español
\title{plantilla para reportes mecatrónica-mecánica UTA}
\usepackage{amsmath}
\usepackage{amssymb,amsfonts,latexsym}
\usepackage{graphicx}
\usepackage{epstopdf}%para convertir figuras a formato pdf
\usepackage{color}
\usepackage{url}  \urlstyle{same}%para conectar url strings en bibliografías
\usepackage{subfigure}%para colocar varias figuras
\usepackage{multicol}
\usepackage{changepage}
\usepackage{float}%para colocar las tablas como H
\usepackage{array}%dar formato a las tablas
\usepackage{longtable}%dar formato a las tablas
\usepackage{bm}
\usepackage{capt-of}
\usepackage{sidecap}
	\sidecaptionvpos{figure}{c}
\usepackage{caption}
\usepackage[final]{pdfpages}
\usepackage{commath}
\usepackage{fontawesome}
\usepackage{fontawesome}
\usepackage{mathrsfs,amsmath}   
\usepackage{xcolor}
\usepackage{cancel}
\usepackage{booktabs}
%%%%%%%%%%% CONFIGURACION DEL DOCUMENTO % %%%%%%%%%%%%
\usepackage{anysize}%para personalizar el ancho de los margenes
\marginsize{2cm}{2cm}{2cm}{2cm}%izquierda, derecha, arriba, abajo
\usepackage{anyfontsize}
\definecolor{ultramarine}{RGB}{0,32,96}
\usepackage{appendix}
\renewcommand{\appendixname}{Apéndices}
\renewcommand{\appendixtocname}{Apéndices}
\renewcommand{\appendixpagename}{Apéndices} 
\usepackage[nottoc]{tocbibind}
% Para que las referencias sean hipervínculos a las figuras o ecuaciones y
% aparezcan en color
\usepackage[colorlinks=true,plainpages=true,citecolor=blue,linkcolor=blue]{hyperref}
%\usepackage{hyperref} 
% Para agregar encabezado y pie de página
\usepackage{fancyhdr} 
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\footnotesize EN2570} %encabezado izquierda
\fancyhead[R]{\footnotesize Ramith Hettiarachchi | 170221T}   % dereecha
\fancyfoot[R]{\footnotesize Digital Signal Processing - Filter Design Project}  % Pie derecha
\fancyfoot[C]{\thepage}  % centro
\fancyfoot[L]{\footnotesize }  %izquierda
\renewcommand{\footrulewidth}{0.4pt}

\usepackage{listings} % Para usar código fuente
\definecolor{dkgreen}{rgb}{0,0.6,0} % Definimos colores para usar en el código
\definecolor{gray}{rgb}{0.5,0.5,0.5} 
% configuración para el lenguaje que queramos utilizar
\lstset{language=Matlab,
   keywords={break,case,catch,continue,else,elseif,end,for,function,
      global,if,otherwise,persistent,return,switch,try,while},
   basicstyle=\ttfamily,
   keywordstyle=\color{blue},
   commentstyle=\color{red},
   stringstyle=\color{dkgreen},
   numbers=left,
   numberstyle=\tiny\color{gray},
   stepnumber=1,
   numbersep=10pt,
   backgroundcolor=\color{white},
   tabsize=4,
   showspaces=false,
   showstringspaces=false}

\newcommand{\sen}{\operatorname{\sen}}	% Definimos el comando \sen para el seno
%en español

\title{Plantilla para informes ing. mecanica-mecatronica} 

%%%%%%%%%%% COMIENZO DEL DOCUMENTO %%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% PORTADA %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
																					%%%
\begin{center}																		%%%
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}									%%%\left
 
 %%%


\includegraphics[scale = 0.30]{logo.png}


													 								%%%
\vspace*{1.0cm}								%%%
																					%%%	
\textsc{\huge  Department of Electronic \& Telecommunication Engineering\\ \vspace{5px} University of Moratuwa }\\[1.5cm]	

\textsc{\LARGE EN2570 Digital Signal Processing }\\[1.5cm]													%%%

\begin{minipage}{0.9\textwidth} 
\begin{center}																					%%%
\textsc{\LARGE Project Report }
\end{center}
\end{minipage}\\[0.5cm]
%%%
    																				%%%
 			\vspace*{1cm}																		%%%
																					%%%
\HRule \\[0.4cm]																	%%%
{ \huge \bfseries FIR Filter Design Project }\\[0.4cm]	%%%
 																					%%%
\HRule \\[1.5cm]																	%%%
 																				%%%
																					%%%
\begin{minipage}{0.46\textwidth}													%%%
\begin{flushleft} \large															%%%

% Aqui a continuación pongan los nombres de los integrantes
\emph{Author:}\\	
Ramith Udara Hettiarachchi\\

%%%
			%\vspace*{2cm}	
            													%%%
										 						%%%
\end{flushleft}																		%%%
\end{minipage}		
																%%%
\begin{minipage}{0.52\textwidth}		
\vspace{-0.6cm}											%%%
\begin{flushright} \large															%%%
\emph{Index Number:} \\																	%%%
170221T\\														%%%
\end{flushright}																	%%%
\end{minipage}	
\vspace*{1cm}
%\begin{flushleft}
 	
%\end{flushleft}
%%%
 		\flushleft{\textbf{\Large }}\\																		%%%
\vspace{2cm} 
\end{center}

\begin{center}	
This report is submitted as a partial fulfillment for the EN2570 - Digital Signal Processing module.\\
{\large \today}																	%%%
\end{center}										  						
%%%%%%%%%%%%%%%% FINAL DE LA PORTADA %%%%%%%%%%%%%%%%%%%%%%%%%%%


\tableofcontents 
\listoffigures
\listoftables
\pagebreak
\newpage
%%%%%%%%%%%%%%%%%%%%%%
\section{Abstract}

Digital filters play a major role in a vast variety of fields. Thus, it is important to understand the fundamental concepts of filter design. 
In this project, the objective is to get hands on experience building a Finite Impulse Response(FIR) Filter. \\ 
FIR filters are designed based on the approximation of an Ideal Filter.

In our scope, an FIR filter will be designed using the windowing method in conjunction with the Kaiser window. The specifications are given in Table \ref{tab:filter-specs}.  \\


% 

%%%%%%%%%%%%%%%%%%%%%



\section{Introduction} 
In this report, my step by step approach in designing the Bandstop FIR Filter is explained. The objective behind this project was to develop our own code without using the built-in function in MATLAB to design the filter. 
Thus, several helper functions were also written to calculate the Bessel function and other tasks. 
\\I carried out the design process using the MATLAB R2019b software, and my code files can be viewed here.
\href{https://github.com/ramithuh/BandStop-FIR-Filter-Design}{https://github.com/ramithuh/BandStop-FIR-Filter-Design \faGithub}\\

The filter specifications corresponding to my index number are listed below.
\\{\bf (170ABC == 170221)}
\begin{table}[H]
    \centering
    \caption{Filter Specifications Given }
    \label{tab:filter-specs}
    \begin{tabular}{@{}llll@{}}
    \toprule
    \textbf{Parameter}    & \textbf{Symbol}        & \textbf{Relationship}         & \textbf{Value}      \\ \midrule
    Maximum passband ripple & $\tilde{A_p}$    & $0.03 + (0.01 \times A)$ dB          & \textbf{0.05 dB}       \\
    Minimum stopband attenuation & $\tilde{A_a}$ & 45+B dB                       & \textbf{47 dB}      \\
    Lower passband edge& $\Omega_{p1}$        & $(C \times 100) + 400$ rad/s         & \textbf{500 rad/s}  \\
    Upper passband edge& $\Omega_{p2}$         & $(C \times 100) + 950$ rad/s        & \textbf{1050 rad/s} \\
    Lower stopband edge& $\Omega_{a1}$          & $(C \times 100) + 500$ rad/s         & \textbf{600 rad/s}  \\
    Upper stopband edge& $\Omega_{a2}$          & $(C \times 100) + 800$ rad/s         & \textbf{900 rad/s}  \\
    Sampling frequency&  $\Omega_{s}$          & $2{[}(C \times 100) + 1300{]}$ rad/s & \textbf{2800 rad/s} \\ \bottomrule
    \end{tabular}
    \end{table}

%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Basic Theory} 

\subsection{Window Method}

Windowing method is one of the simplest ways in which a Finite Impulse Response(FIR) filter can be approximated. 
Equation (1) represents the {\bf ideal desired frequency response.} It is clear that this is non-causal as well as infinite. Therefore, to get an FIR approximation, we need to truncate this ideal desired frequency response. One way to obtain such truncation is known as {\it windowing method}.

\begin{equation}
H_{d}\left( e^{j\Omega }\right) =\sum ^{\infty }_{n=-\infty } h_{d}[ n] \ e^{-j\Omega n}
\end{equation}


We can obtain a causal FIR filter if we truncate $h_{d}[n]$ as described in the equation below.
$$h[ n] \ =\ \bigl\{^{h_{d}[ n] ,\ \ \ \ \ 0\ \leqslant \ n\ \leqslant \ M\ }_{0,\ \ \ otherwise.\ }$$

Equation (2), shows the {\it general} way how the ideal frequency response is truncated in the windowing method according to an {\bf arbitrary window function} $\mathbf{w[n]}.$

\begin{equation}
    h[ n] \ =\ h_{d}[ n] \ w[ n]
\end{equation}

There are various window types/functions introduced over the years. The four window types listed below have only 1 adjustable parameter:{\it window size}.
\begin{itemize}
	\item Hamming
	\item von Hann
	\item Blackman
	\item Barlett
\end{itemize}

\begin{figure}[H]
	\centering
	\begin{minipage}{.5\textwidth}
	  \centering
	  \includegraphics[width=1\linewidth]{windows}
	  \captionof{figure}{Commonly used windows $w[n]$ \cite{oppenheim_schafer_2010}}
	  \label{fig:test1}
	\end{minipage}%
	\begin{minipage}{.5\textwidth}
	  \centering
	  \includegraphics[width=1\linewidth]{windows-res}
	  \captionof{figure}{Amplitude response of common window types $w[n]$ \cite{antoniou_2006}}
	  \label{fig:test2}
	\end{minipage}
\end{figure}




The main problem with most of these windows is that, we cannot control the 
{\it peak approximation error ($20\log{\delta}$ dB)} and the {\it transition width ($\Delta w$, Figure \ref{fig:errors})} simultaneously. 
{\bf Kaiser window method}, provides much convenience to overcome these issues. 
Compared to other window types, the kaiser window method has two parameters: {\it window length \& $\beta$}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.95]{window-char} 
    \caption{Approximation Errors \cite{oppenheim_schafer_2010}}
    \label{fig:errors}
\end{figure}

\subsection{Kaiser Window Method}

Our intention when designing a FIR filter is to make the approximation very much closer to an ideal filter. However, the main two causes to approximation errors, {\it Main-lobe width \& Side-lobe area} are very well linked to each other, which makes it hard to get an optimal filter design in a straightforward manner.
Kaiser, was able to derive a near-optimal window design which can be formed using the zero\textsuperscript{th} order Bessel Function of the first kind. 

The Kaiser window is defined as,

\[
	w_K(nT) = \begin{cases}
	I_0(\beta)/I_0(\alpha) & for \hspace*{3pt} \abs{n}  \leq \frac{N-1}{2}  \\
	0 & otherwise 
	\end{cases}
\]


where $\alpha$ is an independent parameter and\\
$$\beta = \alpha\sqrt{1-\left(\frac{2n}{N-1}\right)^2} \hspace*{50pt} I_0(x) = 1+\sum_{k=1}^{\infty}\left[\frac{1}{k!}\left(\frac{x}{2}\right)^k\right]^2$$\\

As mentioned previously, in this windowing method there are two parameters to be configured.

\begin{enumerate}
	\item Window size
	\item $\beta$ Parameter
\end{enumerate}

As the name suggests, the Window size means the length (N) of the window.
The $\beta$ parameter however is not straightforward. $\beta$ controls the side-lobe levels and the main-lobe width.\cite{kaiser_window_beta_parameter}
{\bf when $ \beta $ increases, the side-lobe levels decreases. However, at the same time, the main lobe becomes wider, which is an adverse effect. }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\section{Kaiser Window - Design Steps}


\subsection{Deriving the Impulse Response of the Ideal Filter}
\subsubsection{Calculating the Realistic Specifications}
As this is a bandstop filter, there will be two transition widths. Therefore, we need to select the narrowest transition width.
$$B_{t1} =  \Omega_{a1}-\Omega_{p1} = \mathbf{\color{ultramarine}100 \ rad/s}$$ 
$$B_{t2} =  \Omega_{p2}-\Omega_{a2} = \mathbf{\color{ultramarine}150 \ rad/s}$$
$$ \star \ \  \mathbf{B_{t}} \ =\ min( B_{t1} ,B_{t2})$$

Thus, $\Omega_{c1}$ \& $\Omega_{c2}$ becomes,
$ \Omega_{c1} =\ \Omega_{p1}+\frac{\mathbf{B_{t}}}{2}$ $\ {\displaystyle ,} \ $
$ \Omega_{c2} =\ \Omega_{p2}-\frac{\mathbf{B_{t}}}{2}$.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.8]{HW} 
    \caption{$H(e^{j\Omega T})$  - Red dotted lines represent $\Omega_{p1}, \Omega_{a1},\Omega_{a2},\Omega_{p2}$}
    \label{fig:Bandstop}
\end{figure}

\subsubsection{Impulse Response of the Ideal Bandstop Filter}

\justify
    The frequency response of an ideal bandstop filter with cutoff frequencies $\Omega_{c1}$ and $\Omega_{c2}$ is given by\\
    \[
     H(e^{j\Omega T}) = \begin{cases}
     1 & for \hspace*{3pt} 0 \leq \abs{\Omega} \leq \Omega_{c1} \\
     0 & for \hspace*{3pt} \Omega_{c1} \leq \abs{\Omega} \leq \Omega_{c2} \\
     1 & for \hspace*{3pt} \Omega_{c2} \leq \abs{\Omega} \leq \frac{\Omega_s}{2}
    \end{cases}
    \]\\
    Using the inverse Fourier transform we get,\\
    $$h(nT) = \frac{1}{\Omega_s}\int_{-\Omega_s/2}^{\Omega_s/2}H(e^{j\Omega T})e^{j\Omega nT}d\Omega$$\\
    \vspace*{-20pt}
    $$h(nT) = \frac{1}{\Omega_s}\left[\int_{-\Omega_s/2}^{-\Omega_{c2}}e^{j\Omega nT}d\Omega+\int_{-\Omega_{c1}}^{0}e^{j\Omega nT}d\Omega+\int_{0}^{\Omega_{c1}}e^{j\Omega nT}d\Omega+\int_{\Omega_{c2}}^{\Omega_s/2}e^{j\Omega nT}d\Omega\right]$$\\
    So the ideal impulse response $h(nT)$,\\
    \[
     h(nT) = \begin{cases}
     1 + \frac{2}{\Omega_s}(\Omega_{c1}-\Omega_{c2}) & for \hspace*{3pt} n=0\\
     \frac{1}{n\pi}(sin(\Omega_{c1}nT) - sin(\Omega_{c2}nT) & otherwise
    \end{cases}
    \]\\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.9]{bandstop} 
    \caption{Intended Bandstop Filter Characteristics \cite{antoniou_2006}}
    \label{fig:Bandstop}
\end{figure}


In summary we have the derived parameters, 
\begin{center}
    \begin{table*}[h]
    \centering
    \caption {Derived Filter Specifications}
    \begin{tabular}{@{}lcccl@{}}
        \toprule
            {Specification} & {Symbol} & {Derivation} & {Value} & {Units}  \\
            \midrule
            Lower transition width & $B_{t1}$           & $\Omega_{a1}-\Omega_{p1}$   & 100     & rad$s^{-1}$  \\
            Upper transition width & $B_{t2}$           & $\Omega_{p2}-\Omega_{a2}$   & 150     & rad$s^{-1}$  \\
            Critical transition width & $B_t$           & $ min( B_{t1} ,B_{t2})$        & 100     & rad$s^{-1}$  \\
            Lower cutoff frequency & $\Omega_{c1}$      & $\Omega_{p1}+\frac{B_t}{2}$ & 550     & rad$s^{-1}$  \\
            Upper cutoff frequency & $\Omega_{c2}$      & $\Omega_{p2}-\frac{B_t}{2}$ & 1000    & rad$s^{-1}$  \\
            Sampling period & $T$                       & $\frac{2\pi}{\Omega_s}$     & 0.002244  & s  \\
        \bottomrule
    \end{tabular}
    \end{table*}
    \end{center}

\subsection{Kaiser Parameters}
\subsubsection{Deriving $\delta$}
The passband amplitude response oscillates between (1 - $\sigma$) and (1 + $\sigma$). The stopband amplitude response oscillates between 0 and $\sigma$.
\\Therefore we are constrained under, {\bf Maximum passband ripple $\mathbf{\tilde{A_p}}$} and {\bf Minimum stopband attenuation $\mathbf{\tilde{A_a}}$ }
\\Since these constraints are given in decibels, we need to establish a relationship between $\sigma$,
 ${A_p}$ \& ${A_a}$

$$A_{a} =-20log|\delta | \ \  (stopband \ attenuation)\  \Rightarrow \ \ \ \ \tilde{\delta _{a}} =10^{-0.05\tilde{A_{a}}} $$
$$A_{p} =20log\frac{1+\delta }{1-\delta } \ \ (passband \ ripple)\ \ \ \ \ \ \ \Rightarrow \ \  \tilde{\delta _{p}} =\frac{10^{0.05\tilde{A_{p}}} -1}{10^{0.05\tilde{A_{p}}} +1} \ 
$$

Because it might not be possible to achieve the {Maximum passband ripple $\mathbf{\tilde{A_p}}$} and {Minimum stopband attenuation $\mathbf{\tilde{A_a}}$} in exact value
with the same $\delta$, we build a filter that might over-satisfy one or both specifications. 
So we pick $\delta$ such that $A_{p} \ \leqslant \ \tilde{A_{p}} \ \ \ and\ \ \ A_{a} \ \geqslant \tilde{A_{a}}$ conditions both satisfy at the same time. Therefore,
$$\delta = min\left(\tilde{\delta_p},\tilde{\delta_a}\right)$$

{\color{ultramarine} \bf Minimum stopband attenuation $\mathbf{\tilde{A_a} = 47 dB} \ \ \Rightarrow \ \ \tilde{\delta _{a}}= 0.00446684 $}\\
{\color{ultramarine} \bf Maximum passband ripple \ \ \ \ \  \ \ \ \ $\mathbf{\tilde{A_p} = 0.05 dB} \ \ \Rightarrow \ \ \tilde{\delta _{p}}= 0.00287822$} 
{\color{ultramarine} $$\mathbf{\therefore \delta = 0.00287822}$$}

\subsubsection{Calculating Actual Stopband Loss $A_a$ \& Passband Ripple $A_p$}
Now that we've found $\delta$ we can find the actual stopband loss/attenuation,

{\color{ultramarine} $$A_{a} =-20log|\delta | = -20log|0.00287822| = 50.8175 $$}
{\color{ultramarine}$$A_{p} =20log|\frac{1+0.00287822 }{1-0.00287822 }|0  = 0.05 $$}
\subsubsection{Choosing Parameter $\alpha$}
\[
    \alpha = \begin{cases}
    0 & for \hspace*{3pt} A_a \leq 21 dB \\ 
    0.5842(A_a - 21)^{0.4} + 0.07886(A_a - 21) & for \hspace*{3pt} 21 < A_a \leq 50 dB \\
    0.1102(A_a - 8.7) & for \hspace*{3pt} A_a > 50 dB
   \end{cases}
   \]\\

   {\color{ultramarine} Since $A_a>50dB$, $\alpha = 0.1102(A_a - 8.7) = 0.1102(50.8175 - 8.7) = 4.64135$}
  

\subsubsection{Choosing Parameter $D$ \& Window size $N$}

\[
    D = \begin{cases}
    0.9222 & for \hspace*{3pt} A_a \leq 21 dB \\
    \frac{A_a - 7.95}{14.36} & for \hspace*{3pt} A_a > 21 dB
   \end{cases}
   \]\\
{\color{ultramarine} Since $A_a > 21 dB$, $D =  \frac{A_a - 7.95}{14.36}= \frac{50.8175 - 7.95}{14.36} =    2.9852$}
\\
\\
N is chosen such that it is the smallest odd integer value satisfying the inequality 

{\color{ultramarine} $$N\geq\frac{\Omega_sD}{B_t}+1 = \frac{2800 rad/s * 2.9852}{100 rad/s}+1  = 84.5856$$}
Thus, N = 85.

All these parameters were calculated manually, and the results were cross checked with the relevant values got from the MATLAB code. 

\begin{center}
    \begin{table*}[h]
    \centering
    \caption {Kaiser Parameters Summary}
    \begin{tabular}{@{}ccc@{}}
        \toprule
            {Parameter}  & {Value} & {Units}  \\
            \midrule
            $\delta$           & 0.00287822 & -  \\
            $A_a$              & 50.8175    & dB \\
            $A_p$              & 0.05       & dB \\
            $\alpha$           & 4.64135    & -  \\
            $I_0(\alpha)$      & 19.8032    & -  \\
            $D$                & 2.9852     & -  \\
            $N$                & 85         & -  \\
        \bottomrule
    \end{tabular}
    \end{table*}
    \end{center}


\section{Results}
\subsection{Forming the window sequence $w_k(nT)$}

Since the window length ($N$) was computed to be 85, 
We have the kaiser window from $n \leq \abs{\frac{N-1}{2}}.$ \\ n = -42 to n = +42.
\[
	w_K(nT) = \begin{cases}
	I_0(\beta)/I_0(\alpha) & for \hspace*{3pt} \abs{n}  \leq \frac{N}{2}  \\
	0 & otherwise 
	\end{cases}
\]

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{kaiser.eps} 
    \caption{Constructed Kaiser Window}
    \label{fig:kaiser}
\end{figure}

\subsection{Causal Impulse Response of the Bandstop Filter}
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{cir.eps} 
    \caption{Causal Impulse Response}
    \label{fig:kaiser}
\end{figure}

\subsection{Magnitude Response of the Digital Filter}
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{mag.eps} 
    \caption{Magnitude Response of the BandStop Filter}
    \label{fig:kaiser-freqz}
\end{figure}

\newpage
\subsection{Magnitude Responses of the Passbands}
From figures \ref{fig:Figure9} \& \ref{fig:Figure10}, it is clear that the passband ripples ${A_p}$ are well within the range ${\tilde{A_p}}$=0.05.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\linewidth]{upassband.eps}
    \caption{Upper passband (Zoomed)}
    \label{fig:Figure9}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\linewidth]{lpassband.eps}
    \caption{Lower passband (Zoomed)}
    \label{fig:Figure10}
\end{figure}



\subsection{Input Signal}

\subsubsection{Time Domain}
Note that, only 100 samples from $\mathbf{x( nT)=\sum ^{3}_{i=1} cos[ \Omega _{i} nT]}$ are displayed in this plot.
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.58]{input} 
    \caption{$x( nT) \ =\sum ^{3}_{i=1} cos[ \Omega _{i} nT]$}
\end{figure}
\subsubsection{Frequency Domain}
The raw input signal is a sum of three cosines, therefore, they clearly have peaks at,\\
$\star \ \Omega_1 = \frac{\Omega_{c1}}{2} = 275 \ rad/s$\\
$\star \ \Omega_2 =\Omega_{c1} + \frac{\Omega_{c2}-\Omega_{c1}}{2}=775\ rad/s$\\
$\star \ \Omega_3 = \Omega_{c2} + \frac{\Omega_s/2-\Omega_c2}{2}=1200\ rad/s$
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{Xw.eps} 
\end{figure}

\subsection{Filtered Signal}

$$Input\ Signal Was: \ \ x( nT) \ =\sum ^{3}_{i=1} cos[ \Omega _{i} nT]$$
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{filtered} 
    \caption{$x( nT) \ *\ h_{w}( nT)$}
    \label{fig:filtered-signal}
\end{figure}
By the bandstop filter, our intention was to attenuate frequencies from 550 rad/s to 1000 rad/s, which has been done successfully. 

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{filtered_mag} 
    \caption{$\mathscr{F} \ ( x( nT) \ *\ h_{w}( nT))$}
\end{figure}

\subsection{Expected Outputs}
Figure 14, shows the plot of the expected filtered signal which is, $ cos[ \Omega _{1} nT] \ +\ cos[ \Omega _{3} nT]$

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{efs.eps} 
    \caption{$\mathscr{F} \ ( cos[ \Omega _{1} nT] \ +\ cos[ \Omega _{3} nT])$}
\end{figure}

\section{Discussion}
With the design steps that were mentioned, I was able to make a Bandstop FIR Filter using the Kaiser Method. It was evident that the designed filter conformed with the specifications in
Table \ref{tab:filter-specs} - $\tilde{A_p}$ =0.05  $\tilde{A_a}$ = 47dB as per the magnitude spectrum in Figure \ref{fig:kaiser-freqz}

The filtered signal was obtained by multiplying the signal and the window in the frequency domain and then taking the inverse fourier transform of the result. And if we observe the filtered signal in Figure \ref{fig:filtered-signal}, it takes more than 40 samples for the signal to reach the steady state.
The reason for this is because the filter we designed had the order 84. Therefore, higher order filters may take more time for the filtered signal to reach the steady state.
\\The designed filter was also compared with the builtin MATLAB functions, $kaiserord \ \& \  fir1$
\\ 
\\
\section{Acknowledgment}
I would like to extend my sincere gratitude towards Dr.Chamira Edussooriya for the guidance provided during this project.

\newpage
\bibliographystyle{unsrt}
\bibliography{References}


\includepdf[pages=1,pagecommand=\section{Appendix},width=\textwidth]{temp_.pdf}
\includepdf[pages=-,pagecommand=\section*{Appendix},width=\textwidth]{BandStop_Kaiser.pdf}

\setlength{\voffset}{-2.54cm}
\setlength{\hoffset}{-2.54cm}
\end{document}

